# Template Maker - Comprehensive Feature Implementation Plan

## Overview
This document outlines the implementation plan for 15 major feature improvements and bug fixes for the Template Maker application.

## Requirements Breakdown

### 0. Save Template Progress When Logging In
**Status**: TODO
**Priority**: HIGH
**Description**: When a user is logged out and working on a template, then logs in, their current work should be saved to their account.
**Implementation**:
- Before login, cache the current canvas state to localStorage
- After successful login, check for cached template data
- Prompt user to save the cached template
- Merge with auto-save functionality

### 1. Fix Undo/Redo Functionality
**Status**: TODO
**Priority**: HIGH
**Description**: Undo clears redo history inappropriately
**Implementation**:
- Fix history stack management in `requestSaveState()`
- Ensure redo stack is only cleared on new actions, not on undo
- Current issue: Line 717 `historyStack.splice(historyIndex + 1);` clears redo

### 2. Light Mode Canvas Background
**Status**: TODO
**Priority**: MEDIUM
**Description**: Canvas grid/dots should be white in light mode
**Implementation**:
- Update `.canvas-wrap` background in light mode theme
- Change from `#2a2a2a` with dark dots to light background with subtle dots

### 3. Zoom Text Color in Light Mode
**Status**: TODO
**Priority**: LOW
**Description**: Zoom text is white in light mode (not readable)
**Implementation**:
- Add color property to zoom level element in light mode CSS

### 4. Null Color Indicator
**Status**: TODO
**Priority**: MEDIUM
**Description**: Show diagonal red line for null colors, add button to set color to null
**Implementation**:
- Modify `colorInputRow()` function
- Add visual indicator for null/transparent colors
- Add button to clear color (set to null)

### 5. Multi-Object Alignment
**Status**: TODO
**Priority**: HIGH
**Description**: Allow alignment between multiple selected objects and with artboard
**Implementation**:
- Add alignment buttons to multi-select inspector
- Implement relative alignment logic (align left edges, centers, etc.)
- Support alignment to page/artboard

### 6. Multi-Text Formatting
**Status**: TODO
**Priority**: MEDIUM
**Description**: When multiple text objects are selected, allow changing all text properties
**Implementation**:
- Enhance `renderMultiSelectInspector()` to detect all-text selection
- Add text-specific controls (font, size, etc.) to multi-select panel

### 7. Text Formatting (Bold, Italic, Underline)
**Status**: TODO
**Priority**: MEDIUM
**Description**: Add underline, bold, and italic formatting to text properties
**Implementation**:
- Add toggle buttons in text inspector
- Use Fabric.js text styles property
- Support inline formatting

### 8. Editable Table Cells
**Status**: TODO
**Priority**: HIGH
**Description**: Allow writing inside tables, select individual cells, change fill colors
**Implementation**:
- Add click handling for individual table cells
- Create text input overlay for cell editing
- Add cell fill color controls
- Store cell data in table group object

### 9. Drag and Drop Layers
**Status**: TODO
**Priority**: MEDIUM
**Description**: Allow reordering layers via drag and drop
**Implementation**:
- Add HTML5 drag-drop to layer items
- Implement z-index reordering on drop
- Visual feedback during drag

### 10. Layer Panel Multi-Select
**Status**: TODO
**Priority**: MEDIUM
**Description**: Allow multi-select in layers panel with Shift/Ctrl
**Implementation**:
- Already partially implemented (line 2111)
- Need to fix activeSelection handling when no object is currently active

### 11. Middle Mouse Button Panning
**Status**: TODO
**Priority**: LOW
**Description**: Pan canvas using middle mouse button
**Implementation**:
- Modify mouse:down handler (line 787)
- Currently only checks for button 1 (middle) or Alt+click
- Need to verify middle button detection works correctly

### 12. High Quality Canvas Rendering
**Status**: PARTIAL
**Priority**: HIGH
**Description**: Ensure canvas always renders at high quality
**Implementation**:
- Already has multiplier in `generateCanvasDataURL()`
- May need to increase devicePixelRatio for canvas rendering
- Add anti-aliasing settings

### 13. Fix Shape Stretching
**Status**: TODO
**Priority**: HIGH
**Description**: Shapes should scale properly, not stretch (maintain stroke width)
**Implementation**:
- Set `strokeUniform: true` on shape creation
- Update scaling handlers to maintain aspect ratio for circles
- Prevent oval creation from circle stretch

### 14. Default Colors (Black/White)
**Status**: TODO
**Priority**: LOW
**Description**: Shapes should default to black outline, white fill; text should be black
**Implementation**:
- Update `adders` object (line 899-907)
- Change default fill from `#f0f0f0` to `#ffffff`
- Change default stroke from `#333` to `#000000`
- Change text fill from current to `#000000`

### 15. General Polish
**Status**: ONGOING
**Priority**: MEDIUM
**Description**: Add missing professional features to match Canva/Figma
**Suggestions**:
- Add keyboard shortcuts display
- Add object grouping shortcuts
- Add zoom presets
- Improve panel UX
- Add tooltips

## Implementation Order

1. **Critical Fixes** (Do First):
   - #1: Undo/Redo
   - #13: Shape Stretching
   - #14: Default Colors
   
2. **High Priority Features**:
   - #0: Login Save Progress
   - #5: Multi-Object Alignment
   - #8: Editable Tables
   - #12: High Quality Rendering

3. **Medium Priority**:
   - #2: Light Mode Canvas
   - #4: Null Color Indicator
   - #6: Multi-Text Formatting
   - #7: Text Formatting (Bold/Italic/Underline)
   - #9: Drag-Drop Layers
   - #10: Layer Multi-Select

4. **Low Priority / Nice to Have**:
   - #3: Zoom Text Color
   - #11: Middle Mouse Panning
   - #15: General Polish

## Testing Checklist
- [ ] Undo/Redo multiple times without losing history
- [ ] Light/Dark theme switching
- [ ] Multi-select alignment in all directions
- [ ] Table cell editing and formatting
- [ ] Layer reordering via drag-drop
- [ ] Shape scaling maintains quality
- [ ] Login from guest mode preserves work
- [ ] Export quality verification
